<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bundelgrootte</title>
  <link rel="stylesheet" href="styles.css" />
  <a href="index.html" class="home-icon"><i class="fas fa-home"></i></a>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    .container {
      max-width: 400px;
      margin: 0 auto;
      padding: 20px;
    }
    label, select, input {
      display: block;
      width: 100%;
      margin-bottom: 10px;
    }
    select, input {
      padding: 8px;
      font-size: 16px;
    }
    button {
      display: block;
      width: 100%;
      padding: 10px;
      background-color: #646464;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background-color: #666;
    }
    .result {
      margin-top: 20px;
      padding: 10px;
      color: black;
      background-color: #f0f0f0;
      border: 1px solid #ccc;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<!-- Info knop -->
<button class="info-btn" onclick="openModal('myModal')">i</button>
<div id="myModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal('myModal')">&times;</span>
    <p>
      Bundelgrootte of FFD berekenen bij vlakke of gebogen oppervlakken.<br>
      <b>Vlakke plaat:</b> tan(hoek/2) = (bundelbreedte/2) / afstand<br>
      <b>Gebogen plaat:</b> Booglengte = bundelhoek(in radialen) × radius<br>
      <b>FFD berekening (concave):</b> FFD = booglengte / hoek(in radialen)
    </p>
  </div>
</div>

<script>
function openModal(id) {
  document.getElementById(id).style.display = "block";
}
function closeModal(id) {
  document.getElementById(id).style.display = "none";
}
</script>

<div class="container">
  <h1 style="color: #F5DF4D; text-align: center;">Bundelgrootte</h1>

  <label for="tubeSelect">Kies een röntgenbuis:</label>
  <select id="tubeSelect">
    <option value="yxlon300">Yxlon 300 3mm brandvlek: 40° x 55°</option>
    <option value="smartEvo300">Yxlon Smart EVO 300DS: 30° x 60°</option>
    <option value="balteauCeram300">Balteau Ceram 300 Directional: 40° x 50°</option>
  </select>

  <label for="calcType">Wat wil je weten:</label>
  <select id="calcType">
    <option value="" disabled selected>Kies een berekening</option>
    <option value="size">Bundelgrootte op vlakke plaat</option>
    <option value="distance">Benodigde FFD voor vlakke plaat</option>
    <option value="concave">Bundelbereik op gebogen oppervlak</option>
    <option value="concaveFFD">Benodigde FFD voor gebogen oppervlak</option>
  </select>

  <div id="ffdField" class="hidden">
    <label for="ffd">Film Focus Afstand (FFD) in cm:</label>
    <input type="number" id="ffd" step="any" />
  </div>

  <div id="beamSizeField" class="hidden">
    <label for="beamSize">Gewenste bundelbereik in cm:</label>
    <input type="number" id="beamSize" step="any" />
  </div>

  <div id="marginField" class="hidden">
    <label for="margin">Voer margepercentage in (%):</label>
    <input type="number" id="margin" value="25" step="any" min="0" />
  </div>

  <div id="diameterField" class="hidden">
    <label for="diameter">Diameter van gebogen oppervlak (cm):</label>
    <input type="number" id="diameter" step="any" />
  </div>

  <div id="ffdConcaveField" class="hidden">
    <label for="ffdConcave">FFD (afstand bron tot middelpunt vat) in cm:</label>
    <input type="number" id="ffdConcave" step="any" />
  </div>

  <div id="arcLengthField" class="hidden">
    <label for="arcLength">Gewenste booglengte (cm):</label>
    <input type="number" id="arcLength" step="any" />
  </div>

  <button onclick="calculate()">Bereken</button>
  <div id="result" class="result"></div>
</div>

<script>
const tubeData = {
  yxlon300: { narrow: 40, wide: 55 },
  smartEvo300: { narrow: 30, wide: 60 },
  balteauCeram300: { narrow: 40, wide: 50 }
};

document.getElementById('calcType').addEventListener('change', function () {
  const value = this.value;
  document.getElementById('ffdField').classList.add('hidden');
  document.getElementById('beamSizeField').classList.add('hidden');
  document.getElementById('marginField').classList.add('hidden');
  document.getElementById('diameterField').classList.add('hidden');
  document.getElementById('ffdConcaveField').classList.add('hidden');
  document.getElementById('arcLengthField').classList.add('hidden');

  if (value === 'size') {
    document.getElementById('ffdField').classList.remove('hidden');
  } else if (value === 'distance') {
    document.getElementById('beamSizeField').classList.remove('hidden');
    document.getElementById('marginField').classList.remove('hidden');
  } else if (value === 'concave') {
    document.getElementById('diameterField').classList.remove('hidden');
    document.getElementById('ffdConcaveField').classList.remove('hidden');
  } else if (value === 'concaveFFD') {
    document.getElementById('diameterField').classList.remove('hidden');
    document.getElementById('arcLengthField').classList.remove('hidden');
  }
});

function calculate() {
  const tube = document.getElementById('tubeSelect').value;
  const calcType = document.getElementById('calcType').value;
  const angles = tubeData[tube];
  const narrowRad = angles.narrow * Math.PI / 180;
  const wideRad = angles.wide * Math.PI / 180;
  const margin = parseFloat(document.getElementById('margin').value) / 100 + 1;

  let resultText = '';

  if (calcType === 'size') {
    const ffd = parseFloat(document.getElementById('ffd').value);
    if (!ffd || ffd <= 0) {
      resultText = 'Voer een geldige FFD in.';
    } else {
      const narrow = 2 * ffd * Math.tan(narrowRad / 2);
      const wide = 2 * ffd * Math.tan(wideRad / 2);
      resultText = `Bundel op vlakke plaat:<br>Smalle kant: ${narrow.toFixed(2)} cm<br>Brede kant: ${wide.toFixed(2)} cm`;
    }
  } else if (calcType === 'distance') {
    const beam = parseFloat(document.getElementById('beamSize').value);
    if (!beam || beam <= 0) {
      resultText = 'Voer een geldig bundelbereik in.';
    } else {
      const ffdNarrow = ((beam / 2) / Math.tan(narrowRad / 2)) * margin;
      const ffdWide = ((beam / 2) / Math.tan(wideRad / 2)) * margin;
      resultText = `Benodigde FFD:<br>Smalle bundel: ${ffdNarrow.toFixed(2)} cm<br>Brede bundel: ${ffdWide.toFixed(2)} cm`;
    }
  } else if (calcType === 'concave') {
    const diameter = parseFloat(document.getElementById('diameter').value);
    const ffd = parseFloat(document.getElementById('ffdConcave').value);
    if (!diameter || !ffd || diameter <= 0 || ffd <= 0) {
      resultText = 'Voer geldige waarden in voor diameter en FFD.';
    } else {
      const radius = diameter / 2;
      const arcNarrow = radius * narrowRad;
      const arcWide = radius * wideRad;
      resultText = `Booglengte op oppervlak:<br>Smalle kant: ${arcNarrow.toFixed(2)} cm<br>Brede kant: ${arcWide.toFixed(2)} cm`;
    }
  } else if (calcType === 'concaveFFD') {
    const diameter = parseFloat(document.getElementById('diameter').value);
    const arcLength = parseFloat(document.getElementById('arcLength').value);
    if (!diameter || !arcLength || diameter <= 0 || arcLength <= 0) {
      resultText = 'Voer geldige waarden in voor diameter en booglengte.';
    } else {
      const radius = diameter / 2;
      const ffdNarrow = arcLength / narrowRad;
      const ffdWide = arcLength / wideRad;
      resultText = `Benodigde afstand (FFD) voor gegeven booglengte:<br>Smalle bundel: ${ffdNarrow.toFixed(2)} cm<br>Brede bundel: ${ffdWide.toFixed(2)} cm`;
    }
  }

  document.getElementById('result').innerHTML = resultText;
}
</script>

</body>
</html>
